%%{init: {
  'theme': 'base',
  'themeVariables': {
    'primaryTextColor': '#000000',
    'secondaryTextColor': '#000000',
    'tertiaryTextColor': '#000000',
    'textColor': '#000000',
    'nodeTextColor': '#000000'
  }
}}%%
flowchart LR
  subgraph Paper_Preprocessor["ğŸ“„ Paper Preprocessor"]
    P["ğŸ“„ PDF Downloader"]
    Magic["ğŸ“„ PDF to Markdown:<br/>MagicPDF"]
  end

  INIT["ğŸ“‹ PDF URL"] --> P --> Magic --> R

  subgraph URL_Extraction["ğŸ” URL Digger"]
    R["ğŸ” Regex åŒ¹é… URL"]
    H["âœ… High Confidence URLs"]
    Pos["â“ Possible URLs"]
    L["ğŸ¤– LLM éªŒè¯ URL"]
    All["ğŸ“‹ All URLs in pdf"]
  end

  R --> H
  R --> Pos
  Pos --> L
  H --> All
  L --> All
  All --> Ctx

  subgraph Scoring["âš¡ URL Evaluator"]
    direction TB
    Ctx["âš¡ æå– URL ä¸Šä¸‹æ–‡"]
    S1["ğŸ¤– å°†URLå’Œå…¶ä¸Šä¸‹æ–‡å‘ç»™LLMè¯„åˆ†<br/>(0~5)"]
    S2["ğŸŒ è¿›å…¥URLè®©LLMçœ‹æ˜¯å¦æ˜¯æ•°æ®é›†<br/>(0~5)"]
    S3["ğŸ”‘ å…³é”®å­—åŒ¹é…è¯„åˆ†<br/>(0 or 5)"]
    S["ğŸ“Š ç»¼åˆè¯„åˆ†<br/>(threshold=6)"]
    %% å»é‡
    RD["ğŸ” å»é‡"]
  end

  Ctx --> S1 --> S
  Ctx --> S2 --> S
  Ctx --> S3 --> S
  S --> RD --> F["ğŸ¯ DataSet URLs"]

  %% Apply color schemes
  classDef preprocessor fill:#74c0fc,stroke:#1971c2,stroke-width:2px,color:#ffffff
  classDef extraction fill:#51cf66,stroke:#2b8a3e,stroke-width:2px,color:#ffffff
  classDef processing fill:#ffd43b,stroke:#fab005,stroke-width:2px,color:#000000
  classDef scoring fill:#ff8cc8,stroke:#d6336c,stroke-width:2px,color:#ffffff
  classDef output fill:#ff6b6b,stroke:#e03131,stroke-width:2px,color:#ffffff

  %% Apply classes to nodes
  class P,Magic preprocessor
  class R,H,Pos,L,All extraction
  class Ctx,S1,S2,S3 processing
  class S scoring
  class INIT,F output
